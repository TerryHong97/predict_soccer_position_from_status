# predict_soccer_position_from_status
# 프로젝트 목적
본 프로젝트는 서울대학교 2023년 여름학기 AI입문 강의의 첫 번째 과제로 수행되었다.
1)	해결해야 할 문제: 축구게임 내 선수 능력치에 따른 대표 포지션 분류
2)	해당 문제 해결이 중요한 이유: 전략적 시뮬레이션 요소가 가미된 축구게임의 경우, 초상권 등의 제약이 없는 가상의 축구선수를 생성하여 게임 내에서 활용하는 경우가 많다. 이때 랜덤으로 생성되는 축구선수의 능력치에 대해 대표 포지션을 올바르게 설정할 수 있어야 한다.
3)	문제 해결을 위한 방법: 본 프로젝트에서는 FIFA2023 게임에서의 축구 선수 능력치 데이터를 기반으로 랜덤 서치를 활용한 결정트리 분류 모델을 통해 선수의 능력치가 주어지면 대표 포지션을 예측하는 모델을 만들고자 한다.

# 데이터 수집
https://www.kaggle.com/datasets/crxxom/fifa2023-all-cards
본 데이터는 2023년 FIFA2023 게임 내에서 활용되는 실제 축구 선수들의 인게임 능력치와 대표 포지션 등의 정보를 담은 데이터셋이다. 본래 12개의 특징이 있지만 프로젝트 목적에 맞게끔 그중 8개의 특징만 활용하고자 한다.
## 학습샘플 명세서
|번호|특징명|특징값 유형|값의 범위| 
|:---:|:---:|:---:|:--------------:|
|1|Rating|정수|0 ~ 99|
|2|PAC|정수|0 ~ 99|
|3|SHO|정수|0 ~ 99|
|4|PAS|정수|0 ~ 99|
|5|DRI|정수|0 ~ 99|
|6|DEF|정수|0 ~ 99|
|7|PHY|정수|0 ~ 99|
|목표치|Position|문자열|ST/RW/LW/CF/CAM/CM/RM/LM/CDM/CB/RB/LB/RWB/LWB|
## 첫 5명의 학습샘플
|번호|Rating|PAC|SHO|PAS|DRI|DEF|PHY|Position|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
|1|98|94|97|96|99|40|79|FW|
|2|98|93|98|97|99|40|77|FW|
|3|98|95|96|93|96|60|76|MF|
|4|97|90|90|94|98|98|94|MF|
|5|97|99|97|82|94|94|95|FW|

Rating에서는 선수들의 오버롤 능력치를 수치로 표현하고 있으며, PAC는 속력을, SHO는 슛을, PAS는 패스를, DRI는 드리블을, DEF는 수비를, PHY는 피지컬을 수치화하여 나타내고 있다.
각각의 수치는 정수값이며, 최대값은 99이다.

# 데이터 이해와 시각화
![데이터 시각화_1](https://github.com/TerryHong97/predict_soccer_position_from_status/assets/86580697/13be9e18-5247-43aa-b9c0-0e02fbd557ea)
Figure1 분석:
-	수비와 관련된 포지션(CB, RB, RWB, LB, LWB)일수록 수비 능력치가 높고 슈팅 능력치가 낮으며, 공격과 관련된 포지션(ST, RW, LW, CF)일수록 슈팅 능력치가 높고 수비 능력치가 낮다.
-	미드필더(CAM, CM, RM, LM, CDM) 포지션은 공격 포지션과 수비 포지션 중간에 위치해 있다.

![데이터 시각화_2](https://github.com/TerryHong97/predict_soccer_position_from_status/assets/86580697/62513e91-243f-4b1f-b65c-71186ed24e52)
Figure2 분석:
-	수비 포지션일수록 속력과 패스 능력치가 모두 낮은 편에 속한다.
-	미드필드와 공격 포지션은 속력과 패스 둘 다 높은 편에 속하지만, 대체로 미드필드 포지션이 공격 포지션보다 패스 능력치가 더 높고, 공격 포지션이 미드필드 포지션보다 속력 능력치가 더 높다.

![데이터 시각화_3](https://github.com/TerryHong97/predict_soccer_position_from_status/assets/86580697/9bf822d2-81c7-4468-99ce-363e84a32486)
Figure3 분석
-	수비 포지션은 대체로 드리블 능력치는 낮지만 피지컬 능력치가 높은 편에 속한다.
-	공격 포지션과 미드필드 포지션은 둘 다 드리블 능력치는 전반적으로 높은 편에 속하나 피지컬 능력치가 넓게 분포되어 있다. 

Figure1, Figure2, Figure3 종합 분석
-	공격과 미드필드, 수비 포지션은 각 포지션 별 능력치의 특징이 뚜렷하여 능력치 편차에 따라 대표 포지션을 어느정도 짐작할 수 있다.
-	다만 포지션의 개수가 너무 많아 포지션 별로 색을 나누어도 직관적으로 확인하기 어렵다. 

# 데이터 이해를 바탕으로 한 데이터 분석 및 전처리
## 데이터 전처리 과정
![데이터 전처리_1](https://github.com/TerryHong97/predict_soccer_position_from_status/assets/86580697/33f9f9a8-ffac-45b7-a428-6d6968848528)
![데이터 전처리_2](https://github.com/TerryHong97/predict_soccer_position_from_status/assets/86580697/c8d6c6cc-65fa-4de7-aea4-a358681146fc)
![데이터 전처리_3](https://github.com/TerryHong97/predict_soccer_position_from_status/assets/86580697/d1ae9485-2964-4cc6-9e45-7302c233db01)
## 전처리된 최종 데이터 분석
14개의 범주로 되어 있던 타깃 데이터를 “FW”, “MF”, “DF” 세 개의 데이터로 묶어 표현하였다. 
이를 통해 좀더 큰 틀에서의 포지션 성향을 반영한 학습이 진행될 것을 기대할 수 있다.

# 문제 해결을 위해 어떤 알고리즘을 사용할 것인가?
## 머신러닝 알고리즘 설명
본 프로젝트에서는 문제 해결을 위해 결정 트리 분류 모델을 사용하고자 한다.
결정 트리 분류 모델은 머신러닝 알고리즘 중에 설명 가능성이 높은 모델로, 부모 노드와 자식 노드의 지니 불순도 차이가 최대가 되도록 데이터를 분할하는 방식을 통해 결정 트리를 생성하고 이에 따라 분류를 진행한다.
각 노드 별로 어떤 특징을 기준으로 노드를 분할했는지가 드러나기 때문에 모델이 어떤 선수 능력치를 보고 포지션을 분류했을 때 왜 해당 포지션으로 분류했는지 쉽게 파악할 수 있다.
## 알고리즘 코드 설명
결정 트리 분류 모델을 학습시키는데 있어 여러 가지의 하이퍼 파라미터를 정해주어야 하는데, 이를 일일이 정해주기 보다는 확률 분포 객체를 통해 랜덤으로 하이퍼 파라미터를 결정하고 이를 반복하며 최적의 파라미터를 찾는 랜덤 서치 기법을 활용하고자 한다.
이때 사용할 하이퍼 파라미터는 아래와 같다.
- 'min_impurity_decrease' -> 노드를 분할하기 위한 불순도 감소 최소량
- 'max_depth' -> 트리의 깊이 제한
- 'min_samples_split' -> 노드를 나누기 위한 최소 샘플 수
- 'min_samples_leaf' -> 리프 노드가 되기 위한 최소 샘플 개수. 어떤 노드가 분할하여 만들어질 자식 노드의 샘플 수가 이 값보다 작을 경우 분할하지 않음
![랜덤 서치 및 결정 트리 분류_1](https://github.com/TerryHong97/predict_soccer_position_from_status/assets/86580697/dce291f9-7420-4381-8553-52921debbe90)
랜덤 서치를 위한 확률 분포 객체를 만들었으니 이를 기반으로 랜덤 서치 객체를 생성하여 훈련 데이터를 학습시킨다. 500회를 반복하여 하이퍼 파라미터를 랜덤으로 생성 후 학습 및 검증하는 과정을 통해 최적의 모델을 탐색한다.
![랜덤 서치 및 결정 트리 분류_2](https://github.com/TerryHong97/predict_soccer_position_from_status/assets/86580697/6f021a8d-0c08-4a6c-be65-049b3ddf391d)
![랜덤 서치 및 결정 트리 분류_3](https://github.com/TerryHong97/predict_soccer_position_from_status/assets/86580697/d2df5c90-08f4-4003-abc5-f0f734ddabd8)

# 평가 방법 선택 및 결과 분석
## 모델 평가 방법에 대한 설명
랜덤 서치를 통해 찾아낸 최적의 모델을 테스트 데이터셋을 활용하여 score 메서드를 통해 정확도(accuracy)를 평가한다.
## 평가 방법에 사용된 코드
랜덤 서치 객체를 통해 교차 검증이 진행되는데, 교차 검증의 점수들은 랜덤 서치 객체의 `cv_results_` 속성에 저장된다. 또한 랜덤 서치를 통해 찾아낸 최적의 모델은 `best_estimator_` 속성에 저장된다. 이들을 통해 훈련 점수와 테스트 점수를 알 수 있다.

![모델 평가](https://github.com/TerryHong97/predict_soccer_position_from_status/assets/86580697/3c996e3b-9190-42a8-87c3-5a847a2ed318)

## 결과 분석
훈련 점수는 약 0.8085, 테스트 점수는 약 0.8075가 나왔다.
훈련 점수에 비해 테스트 점수가 약간 낮기 때문에, 과대적합으로 보기 어렵다.
하지만 훈련 점수와 테스트 점수 자체가 충분히 높다고 보기 어렵기 때문에, 과소적합 되었다고 할 수 있다.

# 향후 개선 방향
## 프로젝트 요약 설명
본 프로젝트는 축구게임에 사용되는 선수들의 능력치 데이터를 기반으로 해당 선수의 대표 포지션을 예측할 수 있는 모델을 학습시키는 것을 목적으로 한다.
이를 위해 FIFA2023에서 활용되는 10,000명의 축구 선수 데이터를 사용하였다. 해당 데이터 중 축구 선수의 오버롤, 속력, 슛, 패스, 드리블, 수비, 피지컬 능력치 특징을 인풋 데이터로, 축구 선수의 포지션을 타깃 데이터로서 활용하였다.
결정 트리 분류 알고리즘을 사용하여 예측 모델을 만들고자 하였고, 이 과정에서 최적의 검증 점수를 도출하는 모델을 찾기 위해 랜덤 서치를 활용해 여러 가지 하이퍼 파라미터를 탐색하여 최적의 수치를 발견하고자 하였다.
그 결과 0.8085의 훈련 점수, 그리고 0.8075의 테스트 점수가 나왔고, 과소적합 되었음을 알 수 있다.
## 개선 방향
이를 개선하기 위해서는 조금 더 모델의 복잡도를 올려야 할 필요성이 있기에, 특성 공학(Feature Engineering)을 활용해서 추가적인 특징을 만들어내는 방법이 있다.
또한 14개의 포지션을 3개의 범주로 단순화 시키는 과정에서 각 포지션의 성향을 충분히 반영하지 못했을 가능성도 있어, 단순이 공격(FW), 미드필더(MF), 수비(DF) 이외에 윙(RW, LW, RWB, LWB) 범주를 만들어 조금 더 다양한 범주로 타깃 데이터를 구성하는 것도 고려할 수 있다.
